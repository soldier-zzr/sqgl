# 部署指南

本项目支持多人协作模式，需要分别部署前端和后端。

## 一、后端部署（Render）

### 1. 注册 Render 账号
访问 [https://render.com](https://render.com)，使用 GitHub 账号登录。

### 2. 创建新的 Web Service
1. 点击 "New +" → "Web Service"
2. 连接你的 GitHub 仓库 `soldier-zzr/sqgl`
3. 配置如下：
   - **Name**: `sqgl-backend`（或任意名称）
   - **Region**: Singapore（新加坡，速度较快）
   - **Branch**: `main`
   - **Root Directory**: 留空
   - **Runtime**: `Node`
   - **Build Command**: 留空（不需要构建）
   - **Start Command**: `node server.js`
   - **Instance Type**: `Free`（免费套餐）

### 3. 添加环境变量（可选）
在 "Environment" 标签页可以添加：
- `PORT`: Render 会自动设置，无需手动添加

### 4. 点击 "Create Web Service"
等待部署完成（约 2-3 分钟），你会得到一个后端地址，例如：
```
https://sqgl-backend.onrender.com
```

⚠️ **重要**：复制这个地址，下一步会用到！

## 二、前端配置（Netlify）

### 1. 修改 index.html
在 GitHub 仓库中，编辑 `index.html` 文件，找到这一行：
```javascript
window.API_BASE_URL = '';  // 留空则使用本地模式
```

改为（使用你的后端地址）：
```javascript
window.API_BASE_URL = 'https://sqgl-backend.onrender.com';
```

### 2. 提交并推送
```bash
git add index.html
git commit -m "配置后端 API 地址"
git push origin main
```

### 3. Netlify 自动重新部署
Netlify 会自动检测到代码变更并重新部署（约 1-2 分钟）。

## 三、测试

1. 访问你的 Netlify 网站
2. 使用账号登录：`admin` / `123456`
3. 导入数据或添加订单
4. 让同事也登录（使用相同或不同账号）
5. 同事应该能看到相同的数据了！

## 账号说明

系统内置 3 个账号：
- `admin` / `123456` - 管理员（可以查看所有订单）
- `member1` / `123456` - 成员1（只能查看自己的订单）
- `member2` / `123456` - 成员2（只能查看自己的订单）

## 常见问题

### 1. Render 后端会自动休眠吗？
是的，免费版会在 15 分钟无访问后休眠。第一次访问时可能需要等待 30 秒左右唤醒。

### 2. 数据会丢失吗？
不会。数据保存在后端服务器的 `db.json` 文件中。但注意：Render 免费版的文件系统可能在重启后重置，建议定期导出数据备份。

### 3. 如何备份数据？
定期点击 "导出 CSV" 按钮下载数据备份。

### 4. 前端还能本地运行吗？
可以！只需要：
1. 在本地启动后端：`node server.js`
2. 打开 `index.html` 文件
3. 代码会自动检测 localhost 并连接本地后端

## 升级到付费版本（可选）

如果需要更稳定的服务（不休眠、更快速度），可以考虑：
- **Render**: $7/月
- **Railway**: 按使用量计费，约 $5-10/月
- **阿里云/腾讯云**: 轻量服务器约 ¥30-50/月
